(function(t){"use strict";function e(e){t.Object.call(this,1,e),i.fixAR(this);var r=this._;r.freq=t(440),r.osc1=new s(r.samplerate),r.osc2=new s(r.samplerate),r.osc1.step=r.cellsize,r.osc2.step=r.cellsize,r.tmp=new i.SignalArray(r.cellsize),r.beats=.5,this.once("init",n)}var i=t.fn,s=t.modules.Oscillator;i.extend(e);var n=function(){this.wave||(this.wave="sin")},r=e.prototype;Object.defineProperties(r,{wave:{set:function(t){this._.osc1.setWave(t),this._.osc2.setWave(t)},get:function(){return this._.osc1.wave}},freq:{set:function(e){this._.freq=t(e)},get:function(){return this._.freq}},beats:{set:function(t){"number"==typeof t&&t>0&&(this._.beats=t)},get:function(){return this._.beats}}}),r.bang=function(){return this._.osc1.reset(),this._.osc2.reset(),this._.emit("bang"),this},r.process=function(t){var e=this._,s=this.cells[0];if(this.tickID!==t){this.tickID=t;var n,r=s.length,a=e.freq.process(t).cells[0][0],o=e.osc1,h=e.osc2,u=e.tmp;for(o.frequency=a-.5*e.beats,o.process(u),n=0;r>n;++n)s[n]=.5*u[n];for(h.frequency=a+.5*e.beats,h.process(u),n=0;r>n;++n)s[n]+=.5*u[n];i.outputSignalAR(this)}return this},i.register("cosc",e)})(timbre);