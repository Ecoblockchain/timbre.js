(function(t){"use strict";function e(e){return n?n:(n=this,t.Object.call(this,1,e),this.X=new t.ChannelObject(this),this.Y=new t.ChannelObject(this),this.cells[3]=this.X.cell,this.cells[4]=this.Y.cell,s.fixKR(this),void 0)}function i(i){t.Object.call(this,1,i),n||(n=new e([])),s.fixKR(this)}if("browser"===t.envtype){var s=t.fn,n=null;s.extend(e);var r=0,a=0,o=function(t){n._.emit("click",t)},u=function(t){n._.emit("mousedown",t)},h=function(t){for(var e=r=t.clientX/window.innerWidth,i=a=t.clientY/window.innerHeight,s=n.cells[3],o=n.cells[4],u=0,h=s.length;h>u;++u)s[u]=e,o[u]=i},l=function(t){n._.emit("mouseup",t)},c=e.prototype;c.start=function(){return window.addEventListener("click",o,!0),window.addEventListener("mousedown",u,!0),window.addEventListener("mousemove",h,!0),window.addEventListener("mouseup",l,!0),this},c.stop=function(){return window.removeEventListener("click",o,!0),window.removeEventListener("mousedown",u,!0),window.removeEventListener("mousemove",h,!0),window.removeEventListener("mouseup",l,!0),this},c.play=c.pause=function(){return this},s.register("mouse",e),s.extend(i),Object.defineProperties(i.prototype,{min:{set:function(t){var e=this._;e.min=t,e.delta=e.max-e.min,e.map.bang()},get:function(){return this._.min}},max:{set:function(t){var e=this._;e.max=t,e.delta=e.max-e.min,e.map.bang()},get:function(){return this._.max}},curve:{set:function(t){var e=this._;if(f[t]){var i=f[t];e.map.map=function(t){return i(e,t)},e.map.bang(),e.curveName=t}},get:function(){return this._.curveName}}}),i.prototype.start=function(){return n.start(),this},i.prototype.stop=function(){return n.stop(),this},i.prototype.process=function(t){return this._.map.process(t),this};var f={lin:function(t,e){return e*t.delta+t.min},exp:function(t,e){var i=0>t.min?1e-6:t.min;return Math.pow(t.max/i,e)*i},sqr:function(t,e){return e*e*t.delta+t.min},cub:function(t,e){return e*e*e*t.delta+t.min}};s.register("mouse.x",function(e){var s=new i(e),r=s._;r.min=0,r.max=1,r.delta=1,r.curveName="lin";var a=f.lin;return r.map=t("map",{map:function(t){return a(r,t)}},n.X),s.cells[0]=r.map.cells[0],s}),s.register("mouse.y",function(e){var s=new i(e),r=s._;r.min=0,r.max=1,r.delta=1,r.curveName="lin";var a=f.lin;return r.map=t("map",{map:function(t){return a(r,t)}},n.Y),s.cells[0]=r.map.cells[0],s})}})(timbre);