!function(a){"use strict";function b(b){return e?e:(e=this,a.Object.call(this,1,b),this.X=new a.ChannelObject(this),this.Y=new a.ChannelObject(this),this.cells[3]=this.X.cell,this.cells[4]=this.Y.cell,void d.fixKR(this))}function c(c){a.Object.call(this,1,c),e||(e=new b([])),d.fixKR(this)}if("browser"===a.envtype){var d=a.fn,e=null;d.extend(b);var f=0,g=0,h=function(a){e._.emit("click",a)},i=function(a){e._.emit("mousedown",a)},j=function(a){for(var b=f=a.clientX/window.innerWidth,c=g=a.clientY/window.innerHeight,d=e.cells[3],h=e.cells[4],i=0,j=d.length;j>i;++i)d[i]=b,h[i]=c},k=function(a){e._.emit("mouseup",a)},l=b.prototype;l.start=function(){return window.addEventListener("click",h,!0),window.addEventListener("mousedown",i,!0),window.addEventListener("mousemove",j,!0),window.addEventListener("mouseup",k,!0),this},l.stop=function(){return window.removeEventListener("click",h,!0),window.removeEventListener("mousedown",i,!0),window.removeEventListener("mousemove",j,!0),window.removeEventListener("mouseup",k,!0),this},l.play=l.pause=function(){return this},d.register("mouse",b),d.extend(c),Object.defineProperties(c.prototype,{min:{set:function(a){var b=this._;b.min=a,b.delta=b.max-b.min,b.map.bang()},get:function(){return this._.min}},max:{set:function(a){var b=this._;b.max=a,b.delta=b.max-b.min,b.map.bang()},get:function(){return this._.max}},curve:{set:function(a){var b=this._;if(m[a]){var c=m[a];b.map.map=function(a){return c(b,a)},b.map.bang(),b.curveName=a}},get:function(){return this._.curveName}}}),c.prototype.start=function(){return e.start(),this},c.prototype.stop=function(){return e.stop(),this},c.prototype.process=function(a){return this._.map.process(a),this};var m={lin:function(a,b){return b*a.delta+a.min},exp:function(a,b){var c=a.min<0?1e-6:a.min;return Math.pow(a.max/c,b)*c},sqr:function(a,b){return b*b*a.delta+a.min},cub:function(a,b){return b*b*b*a.delta+a.min}};d.register("mouse.x",function(b){var d=new c(b),f=d._;f.min=0,f.max=1,f.delta=1,f.curveName="lin";var g=m.lin;return f.map=a("map",{map:function(a){return g(f,a)}},e.X),d.cells[0]=f.map.cells[0],d}),d.register("mouse.y",function(b){var d=new c(b),f=d._;f.min=0,f.max=1,f.delta=1,f.curveName="lin";var g=m.lin;return f.map=a("map",{map:function(a){return g(f,a)}},e.Y),d.cells[0]=f.map.cells[0],d})}}(timbre);