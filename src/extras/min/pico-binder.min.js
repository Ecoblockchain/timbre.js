(function(t){"use strict";function e(e){t.Object.call(this,2,e)}var i=t.fn;i.extend(e,t.Object);var n=e.prototype;Object.defineProperties(n,{gen:{set:function(t){"object"==typeof t&&t.process&&(this._.gen=t)},get:function(){return this._.gen}}}),n.process=function(t){var e=this._;return this.tickID!==t&&(this.tickID=t,e.gen&&(this._.gen.process(this.cells[1],this.cells[2]),i.outputSignalAR(this))),this};var s,r=function(){function e(e){var i=Math.ceil(Math.log(1.5*t.samplerate)*Math.LOG2E);this.cell=new t.fn.SignalArray(t.cellsize),this.time=125,this.feedback=.25,this.buffer=new t.fn.SignalArray(1<<i),this.mask=(1<<i)-1,this.wet=.45,this.readIndex=0,this.writeIndex=0|this.time/1e3*t.samplerate,e&&this.setParams(e)}var i=e.prototype;return i.setParams=function(e){return e.time&&(this.time=e.time,this.writeIndex=this.readIndex+(0|.001*this.time*t.samplerate)),e.feedback&&(this.feedback=e.feedback),e.wet&&(this.wet=e.wet),this},i.process=function(t,e){var i,n,s,r,a,o,u,h,l,c;for(i=this.cell,n=this.buffer,s=this.writeIndex,r=this.readIndex,a=this.feedback,u=this.wet,h=1-this.wet,l=0,c=i.length;c>l;++l)o=n[r],n[s]=t[l]-o*a,i[l]=t[l]*h+o*u,s+=1,r+=1;if(e)for(l=0;c>l;++l)t[l]=i[l];return this.writeIndex=s&this.mask,this.readIndex=r&this.mask,i},e}();"browser"===t.envtype?(window.pico||(window.pico={}),s=window.pico):"node"===t.envtype&&(global.pico||(global.pico={}),s=global.pico),s&&(Object.defineProperties(s,{env:{get:function(){return t.env}},samplerate:{get:function(){return t.samplerate}},channels:{get:function(){return t.channels}},cellsize:{get:function(){return t.cellsize}},isPlaying:{get:function(){return t.isPlaying}},DelayNode:{value:r}}),i.register("pico.js",e))})(timbre);